<a href="/register" class="btn">+ Add New User</a>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Panel</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<div class="topbar">
    <h2>ADMIN PANEL</h2>
    <div>
        <a href="/dashboard">Dashboard</a>
        <a href="/logout">Logout</a>
    </div>
</div>

<div class="container">

    {% for message in get_flashed_messages() %}
        <div class="alert">{{ message }}</div>
    {% endfor %}

    <div class="card">
        <h3>All Users</h3>

        <table>
            <tr>
                <th>ID</th>
                <th>Username</th>
                <th>Role</th>
                <th>Change Password</th>
                <th>Delete User</th>
            </tr>

            {% for user in users %}
            <tr>
                <td>{{ user.id }}</td>
                <td>{{ user.username }}</td>
                <td>{{ user.role }}</td>

                <!-- CHANGE PASSWORD -->
                <td>
                    <form 
                        action="/admin/change-password/{{ user.id }}" 
                        method="post"
                        style="display:flex; gap:6px; align-items:center;"
                    >
                        <input
                            type="password"
                            name="new_password"
                            placeholder="New password"
                            required
                            minlength="6"
                        >
                        <button type="submit">Update</button>
                    </form>
                </td>

                <!-- DELETE USER -->
                <td>
                    {% if user.role != "admin" %}
                        <a href="/admin/delete-user/{{ user.id }}" class="danger">
                            Delete
                        </a>
                    {% else %}
                        <span style="color:gray;">Protected</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </table>

    </div>
</div>

</body>
</html>